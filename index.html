<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>Recallia ‚Äî Votre m√©moire IA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Recallia : votre m√©moire IA qui rappelle, ex√©cute et fournit une preuve v√©rifiable pour chaque action." />
  <meta name="theme-color" content="#00C2A8" />
  <link rel="canonical" href="https://bacoul.github.io/Recallia-site/">
  <!-- Manifest (PWA) -->
  <link rel="manifest" href="manifest.webmanifest">
  <!-- Polices -->
  <link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Sora:wght@700&display=swap" rel="stylesheet">
  <!-- OG -->
  <meta property="og:title" content="Recallia ‚Äî Votre m√©moire IA">
  <meta property="og:description" content="Vous validez, on ex√©cute, on prouve. Re√ßus v√©rifiables (hash + audit)." />
  <style>
    :root{
      --bg:#0E1116; --card:#0c1421; --line:#1b2432; --text:#F8FAFC; --muted:#A3AEC0;
      --accent:#00C2A8; --accent2:#14B8A6; --ink:#0E1116;
      --radius:18px; --pad:22px; --w:980px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;color:var(--text);
      background:
        radial-gradient(900px 600px at 90% -10%, rgba(0,194,168,.10), transparent 60%),
        radial-gradient(700px 500px at -10% 120%, rgba(20,184,166,.08), transparent 60%),
        var(--bg);
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial
    }
    a{color:inherit;text-decoration:none}
    .wrap{max-width:var(--w);margin:0 auto;padding:26px 18px}
    /* NAV */
    .nav{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
    .brand{display:flex;align-items:center;gap:10px}
    .brand strong{font-family:Sora,Inter,Arial}
    .badge{font-size:12px;color:#cbd5e1;border:1px solid var(--line);padding:4px 10px;border-radius:999px}
    .links a{color:#cbd5e1;margin-left:16px}
    .links a:hover{color:#fff}
    /* HERO minimal */
    .hero{display:grid;grid-template-columns:1.1fr .9fr;gap:28px;align-items:center;margin:12px 0 32px}
    @media (max-width:900px){.hero{grid-template-columns:1fr}}
    h1{font:800 40px/1.12 Sora,Inter,Arial;margin:0 0 12px}
    p.lead{color:var(--muted);font-size:18px;margin:0}
    .cta{display:flex;gap:12px;flex-wrap:wrap;margin-top:18px}
    .btn{display:inline-flex;align-items:center;gap:10px;padding:12px 18px;border-radius:14px;border:1px solid var(--line);font-weight:600}
    .primary{background:linear-gradient(180deg,var(--accent),var(--accent2));color:var(--ink);border:none}
    .ghost{background:transparent;color:#fff}
    .card{background:linear-gradient(180deg,#0f1623,#0b1220);border:1px solid var(--line);border-radius:var(--radius);padding:var(--pad)}
    .mini{font-size:13px;color:var(--muted)}
    /* Sections */
    .sec{margin:56px 0 0}
    h2{font-size:26px;margin:0 0 10px}
    .steps{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
    @media (max-width:900px){.steps{grid-template-columns:1fr}}
    .tile{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:16px}
    .tile h3{margin:0 0 6px;font-size:18px}
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
    @media (max-width:900px){.grid{grid-template-columns:1fr}}
    .kpis{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-top:12px}
    .kpi{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:14px}
    .kpi h3{margin:0 0 6px;color:#9aa4b2;font-size:13px}
    .kpi strong{font-size:22px}
    /* Footer */
    .footer{margin:56px 0 18px;color:#94a3b8;border-top:1px solid var(--line);padding-top:18px;font-size:14px}
    /* Assistant (d√©mo l√©g√®re) */
    .rec-fab{position:fixed;right:18px;bottom:18px;border:0;border-radius:999px;
      padding:14px 16px;background:linear-gradient(180deg,var(--accent),var(--accent2));color:var(--ink);
      font-weight:700;box-shadow:0 10px 30px rgba(0,0,0,.35);z-index:9999}
    .rec-panel{position:fixed;right:18px;bottom:82px;width:min(92vw,380px);
      background:var(--card);border:1px solid var(--line);border-radius:16px;overflow:hidden;
      box-shadow:0 14px 40px rgba(0,0,0,.45);display:none;z-index:9999}
    .rec-head{display:flex;align-items:center;justify-content:space-between;
      padding:10px 12px;background:#0a101b;border-bottom:1px solid var(--line)}
    .rec-body{max-height:54vh;overflow:auto;padding:10px}
    .rec-msg{background:#0f1623;border:1px solid var(--line);border-radius:12px;padding:10px;margin:8px 0}
    .rec-me{background:#102033;border-color:#24405a}
    .rec-input{display:flex;gap:8px;padding:10px;border-top:1px solid var(--line);background:#0a101b}
    .rec-input input{flex:1;border:1px solid var(--line);background:#0c1421;color:#e5edf5;border-radius:10px;padding:10px}
    .rec-input button{border:1px solid #2b3645;background:#111c2b;color:#fff;border-radius:10px;padding:10px 12px}
    .rec-chip{display:inline-block;border:1px solid var(--line);border-radius:999px;padding:6px 10px;margin:6px 6px 0 0;
      font-size:12px;color:#cbd5e1;cursor:pointer}
    /* CTA install discret */
    .install{margin-top:10px}
    .install small{color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <!-- NAV -->
    <div class="nav">
      <a class="brand" href="#top" aria-label="Accueil Recallia">
        <svg width="28" height="28" viewBox="0 0 48 48" aria-hidden="true">
          <defs><linearGradient id="g" x1="0" x2="1"><stop offset="0%" stop-color="#00C2A8"/><stop offset="100%" stop-color="#14B8A6"/></linearGradient></defs>
          <rect x="2" y="2" width="44" height="44" rx="12" fill="url(#g)"/>
          <path d="M16 33V15h10.2c4.9 0 7.8 2.5 7.8 6.3c0 3-1.8 5.3-4.8 6.1L34 33h-5.3l-4.7-4.9H20v4.9h-4zm4-8.5h6c2.2 0 3.7-1.2 3.7-3.1S28.2 18 26 18h-6v6.5z" fill="#0E1116"/></svg>
        <strong>Recallia</strong>
        <span class="badge">v25</span>
      </a>
      <div class="links">
        <a href="#app">App</a>
        <a href="#how">Comment √ßa marche</a>
        <a href="#bench">Benchmarks</a>
        <a href="#help">Aide</a>
      </div>
    </div>

    <!-- HERO -->
    <section class="hero" id="top">
      <div>
        <h1>Votre m√©moire IA ‚Äî simple, calme, efficace.</h1>
        <p class="lead">Vous validez, on le fait. Chaque action r√©ussie a un <strong>re√ßu v√©rifiable</strong> (hash + audit).</p>
        <div class="cta">
          <a class="btn primary" href="#app">Essayer maintenant</a>
          <a class="btn ghost" href="#proof">Voir une preuve</a>
        </div>
        <div class="install"><small>Pour l‚Äôapp : menu du navigateur ‚Üí ‚ÄúInstaller l‚Äôapplication‚Äù.</small></div>
      </div>
      <div class="card" id="proof" aria-label="Exemple de preuve">
        <h2>Exemple de preuve</h2>
        <p class="mini">Re√ßu horodat√© + SHA-256 (d√©monstration).</p>
<pre>{
  "id": "p_demo",
  "action_id": "anniv.mail",
  "timestamp": "2025-08-15T12:00:00Z",
  "sha256": "abc123‚Ä¶",
  "result": {"status":"success","notes":"Message programm√©"}
}</pre>
        <p class="mini">La preuve r√©elle inclut un hash v√©rifiable et un audit cha√Æn√©.</p>
      </div>
    </section>

    <!-- HOW -->
    <section class="sec" id="how">
      <h2>Comment √ßa marche</h2>
      <div class="steps">
        <div class="tile"><h3>1) Dites ce qu‚Äôil faut faire</h3><p>‚ÄúRappel m√©decin demain 10h‚Äù, ‚ÄúPayer facture EDF‚Äù, ‚ÄúAnniversaire de Mamie‚Äù‚Ä¶</p></div>
        <div class="tile"><h3>2) Validez</h3><p>Rien ne part sans votre OK. Caps et garde-fous activ√©s.</p></div>
        <div class="tile"><h3>3) Recevez la preuve</h3><p>Re√ßus JSON/PDF/ICS, horodat√©s et hach√©s.</p></div>
      </div>
    </section>

    <!-- APP -->
    <section class="sec" id="app">
      <h2>L‚Äôapp Recallia (PWA)</h2>
      <div class="grid">
        <div class="tile"><h3>Rappels intelligents</h3><p>Anniv, m√©decin, factures, dossiers‚Ä¶ au bon moment.</p></div>
        <div class="tile"><h3>Ex√©cution assist√©e</h3><p>Vous validez ‚Üí on envoie, on planifie, on classe, on rapporte.</p></div>
        <div class="tile"><h3>Preuve-ou-rien</h3><p>Chaque action r√©ussie g√©n√®re un re√ßu v√©rifiable.</p></div>
      </div>
      <div class="kpis">
        <div class="kpi"><h3>TTV m√©dian</h3><strong id="kpi-ttv">&lt; 60 s</strong></div>
        <div class="kpi"><h3>VSR</h3><strong id="kpi-vsr">‚â• 90%</strong></div>
        <div class="kpi"><h3>Preuves/jour</h3><strong id="kpi-proof">‚Äî</strong></div>
      </div>
    </section>

    <!-- BENCH -->
    <section class="sec" id="bench">
      <h2>Benchmarks (transparence)</h2>
      <div class="grid">
        <div class="tile"><h3>TTV m√©dian</h3><p>&lt; 60 s</p></div>
        <div class="tile"><h3>VSR</h3><p>‚â• 90 % (2 recettes phares)</p></div>
        <div class="tile"><h3>Couverture de preuve</h3><p>100 %</p></div>
      </div>
      <p class="mini">Chiffres publi√©s automatiquement depuis des preuves r√©elles.</p>
    </section>

    <!-- HELP -->
    <section class="sec" id="help">
      <h2>Aide & Contact</h2>
      <div class="tile">
        <p>Installer l‚Äôapp : menu du navigateur ‚Üí ‚ÄúInstaller l‚Äôapplication‚Äù / ‚ÄúAjouter √† l‚Äô√©cran d‚Äôaccueil‚Äù.</p>
        <p>Support : <a href="mailto:support@recallia.app">support@recallia.app</a></p>
        <p>Confidentialit√© : <a href="privacy.html">lire</a> ¬∑ Mentions : <a href="mentions.html">lire</a></p>
      </div>
    </section>

    <!-- FOOT -->
    <footer class="footer">
      ¬© 2025 Recallia ‚Äî ‚ÄúPreuve-ou-rien‚Äù. ¬∑ <a href="privacy.html">Confidentialit√©</a> ¬∑ <a href="mentions.html">Mentions</a>
    </footer>
  </div>

  <!-- D√©filement doux -->
  <script>
    document.addEventListener('click',e=>{
      const a=e.target.closest('a[href^="#"]'); if(!a) return;
      e.preventDefault();
      document.querySelector(a.getAttribute('href'))?.scrollIntoView({behavior:'smooth'});
    });
  </script>

  <!-- Assistant (d√©mo locale, discret mais pr√©sent) -->
  <button class="rec-fab" id="recFab">Assistant</button>
  <div class="rec-panel" id="recPanel" role="dialog" aria-label="Assistant Recallia">
    <div class="rec-head">
      <strong>Assistant Recallia</strong>
      <button id="recClose" title="Fermer" style="background:none;border:0;color:#9aa4b2;font-size:18px">‚úï</button>
    </div>
    <div class="rec-body" id="recBody">
      <div class="rec-msg">
        Bonjour üëã Essayez : <span class="rec-chip">rappel m√©decin demain 10h</span>
        <span class="rec-chip">anniversaire Marie 20/08</span>
        <span class="rec-chip">payer facture 123</span>
        <span class="rec-chip">liste courses: lait, riz</span>
      </div>
    </div>
    <div class="rec-input">
      <input id="recInput" placeholder="Demande-moi une action‚Ä¶ (ex: rappel m√©decin mardi 9h)"/>
      <button id="recSend">Envoyer</button>
    </div>
  </div>
  <script>
  (function(){
    const $ = s => document.querySelector(s);
    const fab = $('#recFab'), panel = $('#recPanel'), body = $('#recBody'),
          input = $('#recInput'), send = $('#recSend'), closeBtn = $('#recClose');

    const toHex = buf => [...new Uint8Array(buf)].map(b=>b.toString(16).padStart(2,'0')).join('');
    async function sha256(txt){ return toHex(await crypto.subtle.digest('SHA-256', new TextEncoder().encode(txt))); }
    function addMsg(html, me=false){
      const m = document.createElement('div'); m.className='rec-msg'+(me?' rec-me':''); m.innerHTML = html;
      body.appendChild(m); body.scrollTop = body.scrollHeight;
    }
    function storeProof(p){
      const k='recallia_proofs'; const arr = JSON.parse(localStorage.getItem(k)||'[]'); arr.unshift(p);
      localStorage.setItem(k, JSON.stringify(arr.slice(0,50)));
    }
    function dtstamp(d){ return d.toISOString().replace(/[-:]/g,'').split('.')[0]+'Z' }

    async function proof(kind, title, result){
      const p = { id:'p_'+Date.now(), action_id:kind, title, kind,
        timestamp:new Date().toISOString(), level:'N1', costs:{eur:0,sec:5}, result };
      p.sha256 = await sha256(JSON.stringify(p));
      storeProof(p);
      addMsg(`<b>Preuve g√©n√©r√©e</b><br><pre>${JSON.stringify(p,null,2)}</pre>`);
    }
    function icsRdv(summary, start){
      const end = new Date(start.getTime()+45*60000);
      const ICS = `BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Recallia//FR
BEGIN:VEVENT
UID:${Date.now()}@recallia
DTSTAMP:${dtstamp(new Date())}
DTSTART:${dtstamp(start)}
DTEND:${dtstamp(end)}
SUMMARY:${summary}
END:VEVENT
END:VCALENDAR`;
      const url = URL.createObjectURL(new Blob([ICS],{type:'text/calendar'}));
      return {url};
    }
    async function handle(cmd){
      const t = cmd.toLowerCase();

      if(t.includes('rappel') && (t.includes('medecin') || t.includes('m√©decin'))){
        const hMatch = /(\d{1,2})h/.exec(t); const h = hMatch ? parseInt(hMatch[1],10) : 10;
        const when = new Date(Date.now()+24*3600*1000); when.setHours(h,0,0,0);
        const {url} = icsRdv('Rendez-vous m√©decin', when);
        addMsg(`‚úÖ Rappel cr√©√©. <a href="${url}" download="rappel-medecin.ics">T√©l√©charger l‚Äô√©v√©nement (.ics)</a>`);
        await proof('rdv.medecin','Rappel m√©decin', {status:'success', notes:`ICS ${when.toLocaleString()}`});
        return;
      }
      if(t.includes('anniversaire')){
        await proof('anniv.msg','Pr√©parer message anniversaire', {status:'success', notes:'Brouillon pr√™t (SMS/Email)'});
        addMsg('üéâ Brouillon de message d‚Äôanniversaire pr√©par√© (d√©mo).');
        return;
      }
      if(t.includes('payer') || t.includes('facture')){
        await proof('bill.pay.draft','Paiement facture (brouillon)', {status:'success', notes:'Pr√©paration SEPA/QR (non ex√©cut√©)'});
        addMsg('üí≥ Brouillon de paiement cr√©√© (pas d‚Äôenvoi r√©el en d√©mo).');
        return;
      }
      if(t.includes('courses') || t.includes('course')){
        const items = (t.split(':')[1]||'').trim() || 'lait, riz';
        await proof('groceries.list','Liste de courses', {status:'success', items:items.split(',').map(s=>s.trim())});
        addMsg('üß∫ Liste not√©e : '+items);
        return;
      }
      addMsg(`Je peux (d√©mo) :<br>‚Ä¢ <em>rappel m√©decin demain 10h</em><br>‚Ä¢ <em>anniversaire Marie 20/08</em><br>‚Ä¢ <em>payer facture 123</em> (brouillon)<br>‚Ä¢ <em>liste courses: lait, riz</em>`);
    }
    fab.onclick = ()=>{ panel.style.display = 'block'; input.focus(); };
    closeBtn.onclick = ()=> panel.style.display = 'none';
    send.onclick = async ()=>{ const v=input.value.trim(); if(!v) return; addMsg(v, true); input.value=''; await handle(v); };
    input.addEventListener('keydown', e=>{ if(e.key==='Enter'){ e.preventDefault(); send.click(); } });
    document.getElementById('recPanel').addEventListener('click', e=>{
      const chip = e.target.closest('.rec-chip'); if(!chip) return;
      input.value = chip.textContent; send.click();
    });
  })();
  </script>

  <!-- PWA : enregistrement SW + bouton install (discret) -->
  <script>
  (function(){
    const BASE = location.pathname.includes('/Recallia-site/') ? '/Recallia-site/' : '/';
    // Enregistre le Service Worker (si pr√©sent)
    if('serviceWorker' in navigator){ navigator.serviceWorker.register(BASE+'sw.js').catch(()=>{}); }

    // Bouton d'installation si le navigateur le propose (Android/Chrome)
    let deferred; const btn=document.getElementById('install-btn');
    window.addEventListener('beforeinstallprompt', (e)=>{ e.preventDefault(); deferred=e; if(btn) btn.style.display='inline-flex'; });
    btn?.addEventListener('click', async ()=>{ if(!deferred) return; deferred.prompt(); await deferred.userChoice; deferred=null; btn.style.display='none'; });
  })();
  </script>

  <!-- Donn√©es structur√©es -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"SoftwareApplication",
    "name":"Recallia",
    "description":"Votre m√©moire IA : rappelle, ex√©cute et prouve.",
    "applicationCategory":"ProductivityApplication",
    "operatingSystem":"Web,PWA",
    "url":"https://bacoul.github.io/Recallia-site/",
    "offers":{"@type":"Offer","price":"0","priceCurrency":"EUR"}
  }
  </script>
  <!-- Recallia ¬∑ Assistant Cr√©ateur (√©dition en live + sauvegarde locale) -->
<style>
  .creator-fab{position:fixed;left:18px;bottom:18px;z-index:9999;border:0;border-radius:999px;
    padding:12px 14px;background:#111c2b;color:#e5edf5;border:1px solid #2b3645;font:600 14px/1 Inter}
  .creator-panel{position:fixed;left:18px;bottom:74px;width:min(92vw,420px);max-height:70vh;overflow:auto;
    background:#0c1421;border:1px solid #1b2432;border-radius:14px;box-shadow:0 16px 40px rgba(0,0,0,.45);
    padding:12px;display:none;z-index:9999;color:#e5edf5;font:14px Inter,system-ui}
  .creator-panel h4{margin:2px 0 8px;font:700 14px Inter;color:#cbd5e1}
  .creator-panel .row{display:flex;gap:8px;flex-wrap:wrap;margin:8px 0}
  .creator-panel input,.creator-panel textarea{width:100%;background:#0f1623;border:1px solid #1b2432;color:#e5edf5;border-radius:10px;padding:8px}
  .creator-panel button{background:#111c2b;border:1px solid #2b3645;color:#e5edf5;border-radius:10px;padding:8px 10px}
  .creator-chip{display:inline-block;border:1px solid #2b3645;border-radius:999px;padding:6px 10px;margin:6px 6px 0 0;font-size:12px;color:#cbd5e1;cursor:pointer}
  .creator-hl{outline:2px dashed #00C2A8;outline-offset:2px}
  .creator-mini{color:#9aa4b2;font-size:12px}
</style>

<button id="creatorFab" class="creator-fab">Cr√©ateur</button>
<div id="creatorPanel" class="creator-panel" role="dialog" aria-label="Assistant Cr√©ateur">
  <h4>Assistant Cr√©ateur</h4>
  <div class="row">
    <button id="creatorEdit">Activer √©dition</button>
    <button id="creatorSave">Sauver</button>
    <button id="creatorExport">Exporter JSON</button>
    <label style="display:inline-flex;gap:6px;align-items:center">
      <input id="creatorImport" type="file" accept="application/json" style="display:none">
      <button id="creatorImportBtn">Importer JSON</button>
    </label>
    <button id="creatorReset">R√©initialiser</button>
  </div>
  <div class="creator-mini">Commandes rapides (une par ligne) :</div>
  <div style="margin-top:6px">
    <span class="creator-chip" data-cmd="titre: Votre m√©moire IA ‚Äî simple, calme, efficace.">titre‚Ä¶</span>
    <span class="creator-chip" data-cmd="sous-titre: Vous validez, on le fait. Chaque action r√©ussie a un re√ßu v√©rifiable.">sous-titre‚Ä¶</span>
    <span class="creator-chip" data-cmd="cta1: Essayer maintenant">cta1‚Ä¶</span>
    <span class="creator-chip" data-cmd="cta2: Voir une preuve">cta2‚Ä¶</span>
    <span class="creator-chip" data-cmd="tile1.titre: Rappels intelligents">tile1.titre‚Ä¶</span>
    <span class="creator-chip" data-cmd="tile1.texte: Anniv, m√©decin, factures‚Ä¶ au bon moment.">tile1.texte‚Ä¶</span>
    <span class="creator-chip" data-cmd="bench.ttv: 45">bench.ttv‚Ä¶</span>
    <span class="creator-chip" data-cmd="meta.title: Recallia ‚Äî Votre m√©moire IA">meta.title‚Ä¶</span>
    <span class="creator-chip" data-cmd="meta.description: Rappelle, ex√©cute et prouve (re√ßus v√©rifiables).">meta.desc‚Ä¶</span>
    <span class="creator-chip" data-cmd="couleur.accent: #00C2A8">couleur‚Ä¶</span>
  </div>
  <textarea id="creatorCmds" rows="6" placeholder="Exemples:
titre: Votre m√©moire IA ‚Äî simple, calme, efficace.
sous-titre: Vous validez, on le fait...
cta1: Essayer maintenant
tile2.titre: Ex√©cution assist√©e
tile2.texte: Vous validez ‚Üí on envoie, on planifie, on classe.
bench.vsr: 93
meta.title: Recallia ‚Äî M√©moire IA
couleur.accent: #00C2A8"></textarea>
  <div class="row">
    <button id="creatorRun">Appliquer</button>
  </div>
  <div id="creatorNote" class="creator-mini"></div>
</div>

<script>
(function(){
  // S√©lecteurs cl√©s (adapt√©s √† ton index actuel v25/v26)
  const SEL = {
    heroTitle: 'section.hero h1',
    heroLead:  'section.hero p.lead',
    cta1:      '.cta .btn.primary',
    cta2:      '.cta .btn.ghost',
    how1t:     '#how .steps .tile:nth-child(1) h3',
    how1p:     '#how .steps .tile:nth-child(1) p',
    how2t:     '#how .steps .tile:nth-child(2) h3',
    how2p:     '#how .steps .tile:nth-child(2) p',
    how3t:     '#how .steps .tile:nth-child(3) h3',
    how3p:     '#how .steps .tile:nth-child(3) p',
    app1t:     '#app .grid .tile:nth-child(1) h3',
    app1p:     '#app .grid .tile:nth-child(1) p',
    app2t:     '#app .grid .tile:nth-child(2) h3',
    app2p:     '#app .grid .tile:nth-child(2) p',
    app3t:     '#app .grid .tile:nth-child(3) h3',
    app3p:     '#app .grid .tile:nth-child(3) p',
    benchTTV:  '#bench .grid .tile:nth-child(1) p',
    benchVSR:  '#bench .grid .tile:nth-child(2) p',
    benchCOV:  '#bench .grid .tile:nth-child(3) p',
    footer:    'footer.footer'
  };

  const $ = (s)=>document.querySelector(s);
  const note = (msg)=>{ const el=$('#creatorNote'); if(el){ el.textContent=msg; } };

  // Chargement & application du "CMS" local
  function loadCMS(){ try{return JSON.parse(localStorage.getItem('rec_cms')||'{}')}catch(_){return{}}}
  function saveCMS(data){ localStorage.setItem('rec_cms', JSON.stringify(data)); }
  function applyCMS(cms){
    const set = (sel, val)=>{ const n=$(sel); if(n && typeof val==='string'){ n.textContent = val; } };
    set(SEL.heroTitle, cms.heroTitle);
    set(SEL.heroLead,  cms.heroLead);
    set(SEL.cta1,      cms.cta1);
    set(SEL.cta2,      cms.cta2);
    set(SEL.how1t,     cms.how1t); set(SEL.how1p, cms.how1p);
    set(SEL.how2t,     cms.how2t); set(SEL.how2p, cms.how2p);
    set(SEL.how3t,     cms.how3t); set(SEL.how3p, cms.how3p);
    set(SEL.app1t,     cms.app1t); set(SEL.app1p, cms.app1p);
    set(SEL.app2t,     cms.app2t); set(SEL.app2p, cms.app2p);
    set(SEL.app3t,     cms.app3t); set(SEL.app3p, cms.app3p);
    if(typeof cms.benchTTV==='number'){ $(SEL.benchTTV)?.textContent = '< '+cms.benchTTV+' s'; }
    if(typeof cms.benchVSR==='number'){ $(SEL.benchVSR)?.textContent = '‚â• '+cms.benchVSR+' %'; }
    if(typeof cms.benchCOV==='number'){ $(SEL.benchCOV)?.textContent = cms.benchCOV+' %'; }
    if(cms.metaTitle){ document.title = cms.metaTitle; }
    if(cms.metaDesc){
      let m=document.querySelector('meta[name="description"]');
      if(!m){ m=document.createElement('meta'); m.name='description'; document.head.appendChild(m); }
      m.content=cms.metaDesc;
    }
    if(cms.colorAccent){
      const r=document.documentElement.style;
      r.setProperty('--accent', cms.colorAccent);
      r.setProperty('--accent2', cms.colorAccent);
    }
  }

  // Init
  const cms = loadCMS(); applyCMS(cms);

  // UI
  const fab = $('#creatorFab'), panel=$('#creatorPanel'), editBtn=$('#creatorEdit');
  const saveBtn=$('#creatorSave'), runBtn=$('#creatorRun'), cmds=$('#creatorCmds');
  const exportBtn=$('#creatorExport'), importBtn=$('#creatorImportBtn'), importInp=$('#creatorImport');
  const resetBtn=$('#creatorReset');

  fab.addEventListener('click', ()=>{ panel.style.display = (panel.style.display==='none'||!panel.style.display)?'block':'none'; });

  // Activer √©dition (contentEditable + surlignage)
  let editing=false, editableNodes=[];
  editBtn.addEventListener('click', ()=>{
    editing=!editing;
    const sels=[SEL.heroTitle,SEL.heroLead,SEL.cta1,SEL.cta2,SEL.how1t,SEL.how1p,SEL.how2t,SEL.how2p,SEL.how3t,SEL.how3p,SEL.app1t,SEL.app1p,SEL.app2t,SEL.app2p,SEL.app3t,SEL.app3p,SEL.benchTTV,SEL.benchVSR,SEL.benchCOV,SEL.footer];
    editableNodes = sels.map(s=>$(s)).filter(Boolean);
    editableNodes.forEach(n=>{ n.contentEditable = editing?'plaintext-only':'false'; n.classList.toggle('creator-hl', editing); });
    editBtn.textContent = editing ? 'D√©sactiver √©dition' : 'Activer √©dition';
    note(editing?'√âdition activ√©e : clique un texte pour le modifier, puis ‚ÄúSauver‚Äù.':'√âdition d√©sactiv√©e.');
  });

  // Sauver (DOM -> CMS -> localStorage)
  saveBtn.addEventListener('click', ()=>{
    const pick = (sel, k)=>{ const n=$(sel); if(n) cms[k]=n.textContent.trim(); };
    pick(SEL.heroTitle,'heroTitle'); pick(SEL.heroLead,'heroLead');
    pick(SEL.cta1,'cta1'); pick(SEL.cta2,'cta2');
    pick(SEL.how1t,'how1t'); pick(SEL.how1p,'how1p');
    pick(SEL.how2t,'how2t'); pick(SEL.how2p,'how2p');
    pick(SEL.how3t,'how3t'); pick(SEL.how3p,'how3p');
    pick(SEL.app1t,'app1t'); pick(SEL.app1p,'app1p');
    pick(SEL.app2t,'app2t'); pick(SEL.app2p,'app2p');
    pick(SEL.app3t,'app3t'); pick(SEL.app3p,'app3p');
    // Bench parse
    const tt=$(SEL.benchTTV)?.textContent||''; const vs=$(SEL.benchVSR)?.textContent||''; const cv=$(SEL.benchCOV)?.textContent||'';
    const num = s=>{const m=(s.match(/\d+/)||[])[0]; return m?parseInt(m,10):undefined;}
    const ntt=num(tt), nvs=num(vs), ncv=num(cv);
    if(ntt!==undefined) cms.benchTTV=ntt;
    if(nvs!==undefined) cms.benchVSR=nvs;
    if(ncv!==undefined) cms.benchCOV=ncv;
    saveCMS(cms);
    note('Sauvegard√© (localStorage). Pense √† Exporter JSON pour versionner dans GitHub.');
  });

  // Commandes (parser ultra-simple)
  function applyCommand(line){
    const [k,...rest]=line.split(':'); if(!k||!rest.length) return;
    const v = rest.join(':').trim();
    const set = (sel,val)=>{ const n=$(sel); if(n){ n.textContent=val; } };
    switch(k.trim().toLowerCase()){
      case 'titre': set(SEL.heroTitle,v); cms.heroTitle=v; break;
      case 'sous-titre': set(SEL.heroLead,v); cms.heroLead=v; break;
      case 'cta1': set(SEL.cta1,v); cms.cta1=v; break;
      case 'cta2': set(SEL.cta2,v); cms.cta2=v; break;
      case 'tile1.titre': set(SEL.app1t,v); cms.app1t=v; break;
      case 'tile1.texte': set(SEL.app1p,v); cms.app1p=v; break;
      case 'tile2.titre': set(SEL.app2t,v); cms.app2t=v; break;
      case 'tile2.texte': set(SEL.app2p,v); cms.app2p=v; break;
      case 'tile3.titre': set(SEL.app3t,v); cms.app3t=v; break;
      case 'tile3.texte': set(SEL.app3p,v); cms.app3p=v; break;
      case 'bench.ttv': $(SEL.benchTTV).textContent='< '+parseInt(v,10)+' s'; cms.benchTTV=parseInt(v,10); break;
      case 'bench.vsr': $(SEL.benchVSR).textContent='‚â• '+parseInt(v,10)+' %'; cms.benchVSR=parseInt(v,10); break;
      case 'bench.cov': $(SEL.benchCOV).textContent=parseInt(v,10)+' %'; cms.benchCOV=parseInt(v,10); break;
      case 'meta.title': document.title=v; cms.metaTitle=v; break;
      case 'meta.description':
      case 'meta.desc': {
        let m=document.querySelector('meta[name="description"]');
        if(!m){ m=document.createElement('meta'); m.name='description'; document.head.appendChild(m); }
        m.content=v; cms.metaDesc=v; break;
      }
      case 'couleur.accent': {
        const r=document.documentElement.style;
        r.setProperty('--accent', v); r.setProperty('--accent2', v); cms.colorAccent=v; break;
      }
      default: /* inconnu, ignore */ break;
    }
  }
  runBtn.addEventListener('click', ()=>{
    const lines = (cmds.value||'').split('\n').map(s=>s.trim()).filter(Boolean);
    lines.forEach(applyCommand);
    saveCMS(cms); note('Commandes appliqu√©es et sauvegard√©es.');
  });

  // Chips -> ajout dans la zone
  document.querySelectorAll('.creator-chip').forEach(ch=>{
    ch.addEventListener('click', ()=>{ cmds.value = (cmds.value?cmds.value+'\n':'') + ch.dataset.cmd; cmds.focus(); });
  });

  // Export / Import
  exportBtn.addEventListener('click', ()=>{
    const blob = new Blob([JSON.stringify(cms,null,2)], {type:'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href=url; a.download='recallia_cms.json'; a.click();
    URL.revokeObjectURL(url);
  });
  importBtn.addEventListener('click', ()=>importInp.click());
  importInp.addEventListener('change', async (e)=>{
    const f=e.target.files?.[0]; if(!f) return;
    try{
      const text = await f.text(); const data = JSON.parse(text);
      saveCMS(data); applyCMS(data); note('Import effectu√© et appliqu√©.');
    }catch(err){ note('Import invalide.'); }
  });

  // Reset
  resetBtn.addEventListener('click', ()=>{
    if(!confirm('R√©initialiser les modifications locales ?')) return;
    localStorage.removeItem('rec_cms'); location.reload();
  });
})();
</script>
<!-- /Assistant Cr√©ateur -->
</body>
</html>
