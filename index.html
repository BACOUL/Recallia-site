<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Recallia ‚Äî Votre m√©moire IA</title>
  <meta name="description" content="Recallia rappelle, ex√©cute et prouve. Vous validez, on le fait. Chaque action r√©ussie a un re√ßu horodat√© (hash + journal d‚Äôaudit)." />
  <meta name="theme-color" content="#00C2A8" />
  <link rel="manifest" href="manifeste.webmanifest" />
  <link rel="icon" href="data:;base64,iVBORw0KGgo=" />
  <style>
    :root{
      --bg:#0E1116; --panel:#131821; --text:#E8F1F2; --muted:#A7B0B5;
      --accent:#00C2A8; --accent-2: rgba(0,194,168,.12);
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Ubuntu,"Helvetica Neue",Arial,sans-serif;}
    a{color:inherit;text-decoration:none}
    .wrap{max-width:1120px;margin:0 auto;padding:28px 20px}
    header{display:flex;align-items:center;gap:12px}
    .logo{display:inline-flex;align-items:center;gap:10px}
    .badge{background:var(--accent-2);color:var(--accent);padding:4px 10px;border-radius:999px;font-size:12px}
    nav{margin-left:auto;display:flex;gap:14px;flex-wrap:wrap}
    .btn{background:var(--accent);color:#002d27;border:0;padding:12px 18px;border-radius:10px;font-weight:700;cursor:pointer}
    .btn.ghost{background:transparent;border:1px solid #2b333d;color:var(--text)}
    .hero{margin:26px 0 8px;display:grid;gap:18px}
    h1{font-size:clamp(34px,5vw,56px);line-height:1.05;margin:0}
    .lead{color:var(--muted);font-size:18px;max-width:850px}
    .cta{display:flex;gap:12px;flex-wrap:wrap}
    .cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px;margin:24px 0}
    .card{background:var(--panel);border:1px solid #1c2430;border-radius:14px;padding:16px}
    .kpi{font-size:13px;color:var(--muted);margin:0 0 6px}
    .kpi strong{color:var(--text)}
    .code{background:#0b0f15;border:1px solid #1c2430;border-radius:12px;padding:14px;overflow:auto;font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;font-size:13px}
    .section h2{margin:6px 0 10px;font-size:26px}
    footer{margin-top:34px;padding:22px 0;border-top:1px solid #1c2430;color:#8fa1aa;font-size:14px}
    /* PWA install banner */
    #pwaInstall{position:fixed;right:12px;bottom:12px;display:none;background:#101521;border:1px solid #1c2430;border-radius:14px;padding:14px;gap:10px;align-items:center;z-index:20}
    #pwaInstall .btn{padding:10px 14px}
    /* Cr√©ateur (fab + panneau) */
    #creatorFab{position:fixed;right:12px;bottom:82px;background:var(--accent);color:#002d27;border:0;border-radius:999px;padding:10px 14px;font-weight:800;display:none;z-index:20}
    #creator{position:fixed;right:12px;bottom:82px;max-width:420px;width:calc(100% - 24px);display:none;background:#0f141d;border:1px solid #1c2430;border-radius:16px;padding:14px;z-index:21}
    #creator h3{margin:0 0 8px}
    #creator label{font-size:12px;color:#93a0a8}
    #creator input{width:100%;margin:4px 0 12px;padding:10px;border-radius:10px;border:1px solid #233042;background:#0b1119;color:var(--text)}
    #creator .row{display:flex;gap:10px;flex-wrap:wrap}
    #creator .row .btn{flex:1}
    .pill{display:inline-flex;align-items:center;gap:8px;background:var(--accent-2);color:var(--accent);padding:6px 10px;border-radius:999px;font-weight:700}
    .ok{color:#1bd5a6}.warn{color:#ffbe55}
  </style>
  <link rel="manifest" href="manifest.webmanifest">
<link rel="icon" sizes="192x192" href="icon-192.png">
<link rel="icon" sizes="512x512" href="icon-512.png">
</head>
  <head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Recallia ‚Äî Votre m√©moire IA</title>

  <!-- SEO de base -->
  <meta name="description" content="Recallia rappelle, ex√©cute et prouve. Vous validez, on le fait." />
  <link rel="canonical" href="https://bacoul.github.io/Recallia-site/" />

  <!-- Open Graph / Twitter -->
  <meta property="og:title" content="Recallia ‚Äî Votre m√©moire IA" />
  <meta property="og:description" content="Rappelle, ex√©cute, prouve (hash + journal)." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://bacoul.github.io/Recallia-site/" />
  <meta name="twitter:card" content="summary_large_image" />

  <!-- PWA -->
  <link rel="manifest" href="/manifest.webmanifest">
  <meta name="theme-color" content="#00C2A8" />

  <!-- Ic√¥nes PWA (noms sans accent) -->
  <link rel="icon" sizes="192x192" href="/icon-192.png" />
  <link rel="icon" sizes="512x512" href="/icon-512.png" />

  <!-- Styles: garde ta feuille inline existante, on ajoute juste 2 petites r√®gles ci-dessous au besoin -->
  <style>
    /* Correctifs mobile rapides */
    header nav { display:flex; gap:12px; flex-wrap:wrap; justify-content:center; }
    .wrap { max-width: 1100px; margin: 0 auto; padding: 0 16px; }
  </style>
  </head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">
        <div class="pill">R</div>
        <strong>Recallia</strong>
        <span class="badge">v1</span>
      </div>
      <nav>
        <a href="#app" class="btn">Essayer maintenant</a>
        <a href="#preuve" class="btn ghost">Voir une preuve</a>
      </nav>
    </header>

    <section class="hero">
      <h1 id="heroTitle">Votre m√©moire IA qui rappelle, ex√©cute, prouve.</h1>
      <p class="lead" id="heroSub">Vous validez, on le fait. Chaque action r√©ussie a un re√ßu horodat√© (hash + journal d‚Äôaudit).</p>
      <div class="cta">
        <a href="#app" class="btn" id="heroCta">D√©marrer</a>
        <button class="btn ghost" id="installBtn" style="display:none">Installer l‚Äôapp</button>
      </div>
      <div class="cards">
        <div class="card"><p class="kpi">TTV m√©dian</p><h3><strong>&lt; 60 s</strong></h3></div>
        <div class="card"><p class="kpi">VSR</p><h3><strong>&ge; 90 %</strong></h3></div>
        <div class="card"><p class="kpi">Preuve</p><h3><strong>100 % actions r√©ussies</strong></h3></div>
      </div>
    </section>

    <section class="section" id="preuve">
      <h2>Exemple de preuve</h2>
      <div class="code" aria-label="Exemple de re√ßu de preuve">
{
  "id": "p_demo",
  "action_id": "anniv.mail",
  "timestamp": "2025-08-15T12:00:00Z",
  "sha256": "abc123‚Ä¶",
  "result": {"status":"success","notes":"Message envoy√©"}
}
      </div>
    </section>

    <section class="section">
      <h2>Ce que fait Recallia</h2>
      <div class="cards">
        <div class="card"><strong>Rappelle</strong><br /><span class="muted">Anniversaires, rendez-vous, √©ch√©ances.</span></div>
        <div class="card"><strong>Ex√©cute</strong><br /><span class="muted">Envoie d‚Äôemails, formulaires, relances.</span></div>
        <div class="card"><strong>Prouve</strong><br /><span class="muted">Re√ßus JSON/PDF/ICS, horodat√©s + hash.</span></div>
        <div class="card"><strong>Contr√¥le</strong><br /><span class="muted">N0‚ÜíN3, caps ‚Ç¨, temps, risque, pause globale.</span></div>
      </div>
    </section>

    <footer>
      ¬© 2025 Recallia ‚Äî <a href="confidentialite.html">Confidentialit√©</a> ¬∑ <a href="mentions-legales.html">Mentions l√©gales</a>
    </footer>
  </div>

  <!-- Banni√®re d‚Äôinstallation PWA (affich√©e quand dispo) -->
  <div id="pwaInstall" role="dialog" aria-live="polite">
    <div>
      <strong>Installer l‚Äôapp</strong><br/><span style="color:var(--muted)">Acc√®s rapide hors-ligne.</span>
    </div>
    <button class="btn" id="pwaInstallBtn">Installer</button>
  </div>

  <!-- Bouton & panneau Cr√©ateur (PIN) -->
  <button id="creatorFab">üîß Cr√©ateur</button>
  <div id="creator" aria-modal="true" role="dialog">
    <h3>Cr√©ateur (priv√©)</h3>
    <div style="margin-bottom:8px;color:#93a0a8">üîí Saisi PIN pour ouvrir&nbsp;: <code>2718</code></div>
    <div id="creatorLocked" class="row" style="margin-bottom:10px">
      <input id="pin" placeholder="PIN" inputmode="numeric" />
      <button class="btn" id="pinOk">D√©verrouiller</button>
    </div>

    <div id="creatorForm" style="display:none">
      <label>Titre</label><input id="fTitle" />
      <label>Sous-titre</label><input id="fSub" />
      <label>CTA</label><input id="fCta" />
      <label>Couleur d‚Äôaccent (hex)</label><input id="fAccent" placeholder="#00C2A8" />
      <div class="row">
        <button class="btn" id="apply">Appliquer</button>
        <button class="btn ghost" id="propose">Proposer</button>
        <button class="btn ghost" id="save">Sauver</button>
      </div>
      <div style="margin-top:8px;color:#93a0a8">√âtat : <span id="creatorState" class="warn">non sauvegard√©</span></div>
    </div>
  </div>

  <script>
  // ---- Utilitaires
  const $ = s => document.querySelector(s);
  const setAccent = hex => {
    if(!/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(hex||"")) return;
    document.documentElement.style.setProperty('--accent', hex);
    document.documentElement.style.setProperty('--accent-2', hex+'20');
    document.querySelector('meta[name="theme-color"]').setAttribute('content', hex);
  };
  const saveSite = () => {
    localStorage.setItem('recallia.site', JSON.stringify({
      title: $('#heroTitle').textContent,
      sub: $('#heroSub').textContent,
      cta: $('#heroCta').textContent,
      accent: getComputedStyle(document.documentElement).getPropertyValue('--accent').trim()
    }));
    $('#creatorState').textContent = 'sauvegard√©'; $('#creatorState').className='ok';
  };
  const loadSite = () => {
    const s = localStorage.getItem('recallia.site');
    if(!s) return;
    try{
      const v = JSON.parse(s);
      if(v.title) $('#heroTitle').textContent = v.title;
      if(v.sub)   $('#heroSub').textContent   = v.sub;
      if(v.cta)   $('#heroCta').textContent   = v.cta;
      if(v.accent) setAccent(v.accent);
    }catch(e){}
  };

  // ---- PWA : SW + bouton d‚Äôinstallation
  if('serviceWorker' in navigator){ navigator.serviceWorker.register('./sw.js').catch(()=>{}); }
  let deferredPrompt=null;
  window.addEventListener('beforeinstallprompt', (e)=>{
    e.preventDefault(); deferredPrompt = e;
    $('#installBtn').style.display='inline-flex';
    $('#pwaInstall').style.display='flex';
  });
  const doInstall = async ()=>{
    if(!deferredPrompt) return;
    deferredPrompt.prompt();
    await deferredPrompt.userChoice.catch(()=>{});
    $('#pwaInstall').style.display='none';
  };
  $('#installBtn').addEventListener('click',doInstall);
  $('#pwaInstallBtn').addEventListener('click',doInstall);

  // ---- Cr√©ateur (PIN 2718)
  const showFab = ()=>{ $('#creatorFab').style.display='inline-flex'; };
  // Appuyer 5 fois sur le badge pour activer le fab (local)
  let taps=0; document.querySelector('.badge').addEventListener('click',()=>{
    taps++; if(taps>=5){ localStorage.setItem('recallia.creator','1'); showFab(); }
    setTimeout(()=>taps=0,1200);
  });
  if(localStorage.getItem('recallia.creator')==='1') showFab();

  const openCreator = ()=>{
    $('#creator').style.display='block';
    const unlocked = localStorage.getItem('recallia.creator.unlocked')==='1';
    $('#creatorLocked').style.display = unlocked ? 'none':'flex';
    $('#creatorForm').style.display   = unlocked ? 'block':'none';
    if(unlocked){
      $('#fTitle').value = $('#heroTitle').textContent;
      $('#fSub').value   = $('#heroSub').textContent;
      $('#fCta').value   = $('#heroCta').textContent;
      $('#fAccent').value= getComputedStyle(document.documentElement).getPropertyValue('--accent').trim()||'#00C2A8';
    }
  };
  $('#creatorFab').addEventListener('click', openCreator);
  $('#pinOk').addEventListener('click', ()=>{
    if($('#pin').value.trim()==='2718'){
      localStorage.setItem('recallia.creator.unlocked','1');
      $('#creatorLocked').style.display='none';
      $('#creatorForm').style.display='block';
      $('#creatorState').textContent='d√©verrouill√©';
      $('#creatorState').className='ok';
      $('#fTitle').value = $('#heroTitle').textContent;
      $('#fSub').value   = $('#heroSub').textContent;
      $('#fCta').value   = $('#heroCta').textContent;
      $('#fAccent').value= getComputedStyle(document.documentElement).getPropertyValue('--accent').trim()||'#00C2A8';
    } else {
      $('#creatorState').textContent='PIN invalide';
      $('#creatorState').className='warn';
    }
  });
  $('#apply').addEventListener('click',()=>{
    if($('#fTitle').value) $('#heroTitle').textContent = $('#fTitle').value;
    if($('#fSub').value)   $('#heroSub').textContent   = $('#fSub').value;
    if($('#fCta').value)   $('#heroCta').textContent   = $('#fCta').value;
    if($('#fAccent').value) setAccent($('#fAccent').value.trim());
    $('#creatorState').textContent='appliqu√© (non sauvegard√©)';
    $('#creatorState').className='warn';
  });
  $('#save').addEventListener('click', saveSite);
  $('#propose').addEventListener('click', ()=>{
    // 3 propositions simples (offline) selon le contenu actuel
    const base = [
      {
        t:"Votre m√©moire IA ‚Äî encore plus simple.",
        s:"Vous validez, on ex√©cute. Preuve horodat√©e pour chaque action.",
        c:"Commencer",
        a:"#00C2A8"
      },
      {
        t:"Rappelle, ex√©cute, prouve.",
        s:"Anniversaires, rendez-vous, factures‚Ä¶ le tout sous votre contr√¥le.",
        c:"Essayer",
        a:"#60A5FA"
      },
      {
        t:"Ne rien oublier. Jamais.",
        s:"Des rappels intelligents et des actions avec re√ßus v√©rifiables.",
        c:"Activer Recallia",
        a:"#22D3EE"
      }
    ];
    const pick = base[Math.floor(Math.random()*base.length)];
    $('#fTitle').value = pick.t; $('#fSub').value = pick.s; $('#fCta').value = pick.c; $('#fAccent').value = pick.a;
  });

  // Au chargement
  loadSite();
  </script>
  <script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('/Recallia-site/sw.js').catch(console.error);
    });
  }
  </script>
  <!-- PWA: banni√®re "Installer l'app" -->
<div id="pwaInstall" style="display:none;position:fixed;right:12px;bottom:12px;z-index:9999">
  <button id="pwaBtn" class="btn" style="padding:10px 14px;border-radius:10px;background:#00C2A8;color:#0E1116">
    Installer Recallia
  </button>
</div>

<script>
  // Service Worker
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('/Recallia-site/sw.js').catch(console.error);
    });
  }

  // Banni√®re "Ajouter √† l'√©cran d'accueil"
  let deferredPrompt;
  const box = document.getElementById('pwaInstall');
  const btn = document.getElementById('pwaBtn');

  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    box.style.display = 'block';
  });

  btn?.addEventListener('click', async () => {
    if (!deferredPrompt) return;
    deferredPrompt.prompt();
    await deferredPrompt.userChoice;
    deferredPrompt = null;
    box.style.display = 'none';
  });

  // Masquer si d√©j√† en mode app
  if (window.matchMedia('(display-mode: standalone)').matches) {
    document.getElementById('pwaInstall').style.display = 'none';
  }
</script>
  <script>
/* ---------- Cr√©ateur : proposer 3 options & appliquer ---------- */
(function () {
  // √©l√©ments ‚Äúcibles‚Äù √† mettre √† jour (robuste m√™me sans id)
  const elTitle = document.querySelector('h1') || document.querySelector('[data-hero-title]');
  const elSub   = (elTitle && elTitle.nextElementSibling && elTitle.nextElementSibling.tagName==='P')
                  ? elTitle.nextElementSibling : document.querySelector('p');
  const elCTA   = document.querySelector('a.btn, .cta a, a[href^="#app"]') || document.querySelector('a');

  // panneau cr√©ateur (si pr√©sent)
  const creator = document.querySelector('#creator');
  if (!creator || !elTitle) return;

  const input = creator.querySelector('input, textarea');
  const proposeBtn = creator.querySelector('button[data-action="propose"]');
  const saveBtn    = creator.querySelector('button[data-action="apply"]');

  // g√©n√®re des id√©es √† partir d‚Äôun mini prompt
  function makeIdeas(prompt) {
    const base = [
      {
        title: 'Votre m√©moire IA ‚Äî encore plus simple.',
        sub:   'Vous validez, on le fait. Chaque action r√©ussie a un re√ßu horodat√©.',
        cta:   'Essayer maintenant',
        accent:'#00C2A8'
      },
      {
        title: 'Rappelle, ex√©cute, prouve.',
        sub:   'Des actions faites avec preuve (hash + journal).',
        cta:   'Voir une preuve',
        accent:'#00C2A8'
      },
      {
        title: 'Moins d‚Äôefforts, plus de faits.',
        sub:   'Priorit√©s du jour ‚Üí action ‚Üí re√ßu.',
        cta:   'D√©marrer',
        accent:'#00C2A8'
      }
    ];
    // si l‚Äôutilisateur tape un mot-cl√©, adapte un peu
    if (prompt && prompt.toLowerCase().includes('pro')) {
      base[0].title = 'Recallia Pro ‚Äî votre copilote op√©rationnel';
      base[0].cta   = 'Essayer la version Pro';
    }
    return base;
  }

  function renderIdeas(list){
    const slots = creator.querySelectorAll('[data-idea]');
    slots.forEach((card, i) => {
      const it = list[i];
      if (!it) return;
      card.querySelector('[data-idea-title]').textContent = it.title;
      card.querySelector('[data-idea-sub]').textContent   = it.sub;
      card.querySelector('[data-idea-cta]').textContent   = it.cta;
      card.querySelector('[data-idea-accent]').textContent= it.accent;
      card.dataset.json = JSON.stringify(it);
    });
  }

  proposeBtn?.addEventListener('click', () => {
    renderIdeas(makeIdeas(input?.value?.trim() || ''));
    creator.classList.add('has-ideas');
  });

  // Appliquer = met √† jour le H1, le sous-titre, la couleur et le CTA
  creator.addEventListener('click', (e) => {
    const btn = e.target.closest('button[data-apply-index]');
    if (!btn) return;
    const idx = parseInt(btn.dataset.applyIndex, 10);
    const ideas = creator.querySelectorAll('[data-idea]');
    const card = ideas[idx];
    if (!card || !card.dataset.json) return;
    const data = JSON.parse(card.dataset.json);

    if (elTitle) elTitle.textContent = data.title;
    if (elSub)   elSub.textContent   = data.sub;
    if (elCTA)   elCTA.textContent   = data.cta;

    // applique la couleur d‚Äôaccent comme CSS variable
    document.documentElement.style.setProperty('--accent', data.accent);
    // Feedback visuel
    btn.textContent = 'Appliqu√© ‚úî';
    setTimeout(()=>{ btn.textContent='Appliquer'; }, 1200);
  });
})();

/* ---------- PWA : bouton ‚ÄúInstaller l‚Äôapp‚Äù ---------- */
(function(){
  let deferredPrompt;
  const banner = document.getElementById('pwaInstall');
  const installBtn = banner ? banner.querySelector('button') : null;

  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    if (banner) banner.style.display = 'flex';
  });

  installBtn?.addEventListener('click', async () => {
    if (!deferredPrompt) return;
    deferredPrompt.prompt();
    const { outcome } = await deferredPrompt.userChoice;
    deferredPrompt = null;
    if (banner) banner.style.display = 'none';
  });

  // enregistre le service worker si pr√©sent
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js').catch(()=>{});
  }
})();
      </script>
  <!-- Correctif Recallia ‚Äì PWA + bouton Installer -->
<script>
(function () {
  // 1) Enregistrer le Service Worker (fichier sw.js √† la racine)
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('sw.js').catch(console.warn);
  }

  // 2) Banni√®re d'installation PWA
  let deferredPrompt = null;
  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    const bar = document.getElementById('pwaInstall');
    if (bar) bar.style.display = 'flex';
  });

  window.addEventListener('appinstalled', () => {
    const bar = document.getElementById('pwaInstall');
    if (bar) bar.remove();
  });

  // 3) Action bouton
  window.recalliaInstall = async () => {
    if (!deferredPrompt) return;
    deferredPrompt.prompt();
    await deferredPrompt.userChoice;
    deferredPrompt = null;
  };
})();
</script>

<!-- Bandeau Install (masqu√© tant que le navigateur n‚Äôest pas pr√™t) -->
<div id="pwaInstall" style="
  display:none; position:fixed; left:12px; right:12px; bottom:12px; z-index:9999;
  background:#0E1116; border:1px solid #233246; border-radius:14px; padding:10px 12px;
  gap:10px; align-items:center; justify-content:space-between; box-shadow:0 10px 24px rgba(0,0,0,.35);">
  <span style="color:#cfd8dc">Installez l‚Äôapp Recallia</span>
  <button onclick="recalliaInstall()" style="
    background:#00C2A8; color:#00141B; border:0; padding:10px 14px; border-radius:10px;
    font-weight:700; cursor:pointer;">Installer</button>
</div>
  <!-- ===== Recallia ‚Äì Correctif global PWA + Cr√©ateur (v1) ===== -->
<script>
(function () {
  /* ========== 0) Aides ========== */
  const $ = (s, r=document) => r.querySelector(s);
  const $$ = (s, r=document) => Array.from(r.querySelectorAll(s));
  const log = (...a)=>console.log('[Recallia]', ...a);

  // Applique la couleur d‚Äôaccent (et le theme-color)
  function setAccent(hex) {
    if (!/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test((hex||'').trim())) return;
    document.documentElement.style.setProperty('--accent', hex.trim());
    const m = $('meta[name="theme-color"]') || (()=>{const x=document.createElement('meta');x.name='theme-color';document.head.appendChild(x);return x;})();
    m.content = hex.trim();
  }

  // Sauvegarde locale du hero (titre/sous-titre/cta/couleur)
  function saveSiteState() {
    const state = {
      title: ($('#heroTitle')||$('h1'))?.textContent || '',
      sub:   ($('#heroSub')||$('h1+p'))?.textContent || '',
      cta:   ($('#heroCta')||$('a.btn,.cta a'))?.textContent || '',
      accent: getComputedStyle(document.documentElement).getPropertyValue('--accent').trim() || ''
    };
    localStorage.setItem('recallia.site', JSON.stringify(state));
    return state;
  }
  // Recharge l‚Äô√©tat au chargement
  function loadSiteState() {
    try {
      const s = JSON.parse(localStorage.getItem('recallia.site')||'{}');
      const h1 = $('#heroTitle')||$('h1');
      const p  = $('#heroSub')||$('h1+p');
      const a  = $('#heroCta')||$('a.btn,.cta a');
      if (s.title && h1) h1.textContent = s.title;
      if (s.sub && p && p.tagName==='P') p.textContent = s.sub;
      if (s.cta && a) a.textContent = s.cta;
      if (s.accent) setAccent(s.accent);
    } catch(_) {}
  }

  /* ========== 1) PWA : manifest + SW + banni√®re Install ========== */
  // S‚Äôassure qu‚Äôon a un <link rel="manifest"> (chemin relatif GitHub Pages)
  if (!$('link[rel="manifest"]')) {
    const l = document.createElement('link');
    l.rel = 'manifest';
    // essaie d‚Äôabord "manifeste.webmanifest", sinon "manifest.webmanifest"
    l.href = (window.MANIFEST_HREF || 'manifeste.webmanifest');
    document.head.appendChild(l);
  }
  // Enregistre le Service Worker (chemin relatif projet)
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('sw.js').catch(()=>{});
  }

  // Cr√©e la banni√®re install s‚Äôil n‚Äôy en a pas
  function ensureInstallBanner() {
    let bar = $('#pwaInstall');
    if (bar) return bar;
    bar = document.createElement('div');
    bar.id = 'pwaInstall';
    bar.style.cssText = 'display:none;position:fixed;left:12px;right:12px;bottom:12px;z-index:9999;background:#0E1116;border:1px solid #233246;border-radius:14px;padding:10px 12px;gap:10px;align-items:center;justify-content:space-between;box-shadow:0 10px 24px rgba(0,0,0,.35)';
    bar.innerHTML = '<span style="color:#cfd8dc">Installez l‚Äôapp Recallia</span><button id="pwaBtn" style="background:#00C2A8;color:#00141B;border:0;padding:10px 14px;border-radius:10px;font-weight:700">Installer</button>';
    document.body.appendChild(bar);
    return bar;
  }

  let deferredPrompt = null;
  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    const bar = ensureInstallBanner();
    bar.style.display = 'flex';
    $('#pwaBtn')?.addEventListener('click', async () => {
      if (!deferredPrompt) return;
      deferredPrompt.prompt();
      await (deferredPrompt.userChoice||Promise.resolve());
      deferredPrompt = null;
      bar.style.display = 'none';
    }, { once:true });
  });
  window.addEventListener('appinstalled', () => { const b=$('#pwaInstall'); if(b) b.remove(); });
  if (window.matchMedia('(display-mode: standalone)').matches) { const b=$('#pwaInstall'); if(b) b.style.display='none'; }

  /* ========== 2) Ancre #app (le bouton "Essayer maintenant") ========== */
  window.addEventListener('DOMContentLoaded', () => {
    // Donne un id="app" √† la section PWA s‚Äôil manque
    const appSection = $('#app') || $$('h2').find(h => /app|pwa/i.test(h.textContent||''))?.parentElement;
    if (appSection && !appSection.id) appSection.id = 'app';
    loadSiteState();
  });

  /* ========== 3) Cr√©ateur : Proposer / Appliquer / Sauvegarder ========== */
  // Cibles du hero (robuste)
  const heroTitle = $('#heroTitle') || $('h1');
  const heroSub   = $('#heroSub')   || (heroTitle ? heroTitle.nextElementSibling : null);
  const heroCTA   = $('#heroCta')   || $('a.btn,.cta a,nav a.btn');

  // D√©tecte le panneau Cr√©ateur s‚Äôil existe
  const creator = $('#creator');
  if (creator) {
    function readForm() {
      // Essaye de d√©duire les champs par id/label/ordre
      const inputs = $$('input,textarea', creator);
      let title='', sub='', cta='', accent='';
      inputs.forEach(inp => {
        const v = (inp.value||'').trim();
        const id = (inp.id||'').toLowerCase();
        const label = (inp.previousElementSibling && inp.previousElementSibling.textContent||'').toLowerCase();
        if (!v) return;
        if (id.includes('title') || label.includes('titre')) title = v;
        else if (id.includes('sub') || id.includes('subtitle') || label.includes('sous')) sub = v;
        else if (id.includes('cta') || label.includes('cta')) cta = v;
        else if (id.includes('accent') || label.includes('couleur')) accent = v;
      });
      // fallback par ordre (1er=title, 2e=sub, 3e=cta, 4e=accent)
      if (!title || !sub || !cta || !accent) {
        const t = inputs.map(i=>i.value.trim()).filter(Boolean);
        title  = title  || t[0] || '';
        sub    = sub    || t[1] || '';
        cta    = cta    || t[2] || '';
        accent = accent || t[3] || '';
      }
      return { title, sub, cta, accent };
    }

    function proposeOptions(prompt) {
      const ideas = [
        { title:'Votre m√©moire IA ‚Äî encore plus simple.',
          sub:'Vous validez, on ex√©cute. Chaque action a un re√ßu horodat√© (hash + audit).',
          cta:'Essayer maintenant', accent:'#00C2A8' },
        { title:'Rappelle, ex√©cute, prouve.',
          sub:'Anniversaires, rendez-vous, factures‚Ä¶ preuve par d√©faut.',
          cta:'Voir une preuve', accent:'#60A5FA' },
        { title:'Ne rien oublier. Jamais.',
          sub:'Priorit√©s du jour ‚Üí action ‚Üí re√ßu v√©rifiable.',
          cta:'D√©marrer', accent:'#22D3EE' }
      ];
      if ((prompt||'').toLowerCase().includes('pro')) {
        ideas[0].title = 'Recallia Pro ‚Äî votre copilote op√©rationnel';
        ideas[0].cta = 'Essayer Recallia Pro';
      }
      // Remplit les 1ers inputs trouv√©s si pr√©sents
      const inputs = $$('input,textarea', creator);
      if (inputs[0]) inputs[0].value = ideas[0].title;
      if (inputs[1]) inputs[1].value = ideas[0].sub;
      if (inputs[2]) inputs[2].value = ideas[0].cta;
      if (inputs[3]) inputs[3].value = ideas[0].accent;
      // feedback visuel si un √©l√©ment d‚Äô√©tat existe
      const stateEl = $('#creatorState', creator);
      if (stateEl) { stateEl.textContent = 'proposition pr√™te'; stateEl.className = 'ok'; }
    }

    // D√©l√©gation : reconna√Æt les boutons par id/dataset/texte
    creator.addEventListener('click', (e) => {
      const b = e.target.closest('button, a');
      if (!b) return;
      const txt = (b.textContent||'').toLowerCase();
      const action = b.dataset.action || b.id || (txt.includes('appliquer') ? 'apply' : txt.includes('proposer') ? 'propose' : txt.includes('sauveg') ? 'save' : '');

      if (action === 'propose') {
        e.preventDefault();
        const prompt = ($('input,textarea', creator)?.value||'').trim();
        proposeOptions(prompt);
      }

      if (action === 'apply') {
        e.preventDefault();
        const { title, sub, cta, accent } = readForm();
        if (title && heroTitle) heroTitle.textContent = title;
        if (sub && heroSub && heroSub.tagName === 'P') heroSub.textContent = sub;
        if (cta && heroCTA) heroCTA.textContent = cta;
        if (accent) setAccent(accent);
        const stateEl = $('#creatorState', creator);
        if (stateEl) { stateEl.textContent = 'appliqu√© (non sauvegard√©)'; stateEl.className='warn'; }
      }

      if (action === 'save') {
        e.preventDefault();
        saveSiteState();
        const stateEl = $('#creatorState', creator);
        if (stateEl) { stateEl.textContent = 'sauvegard√©'; stateEl.className='ok'; }
      }
    });
  }

  // Sauvegarde automatique avant de quitter la page
  window.addEventListener('beforeunload', saveSiteState);
})();
</script>
<!-- ===== Recallia ‚Äì Assist v2 (panneau d'aide + v√©rif + mini-patch) ===== -->
<style>
  #assistFab{position:fixed;right:12px;bottom:12px;z-index:9998;background:#00C2A8;color:#00141B;border:0;border-radius:999px;padding:10px 14px;font-weight:800;box-shadow:0 8px 20px rgba(0,0,0,.35);cursor:pointer}
  #assistPanel{position:fixed;right:12px;bottom:62px;z-index:9999;width:min(440px,calc(100% - 24px));background:#0E1116;color:#E8F1F2;border:1px solid #233246;border-radius:14px;padding:12px;display:none}
  #assistPanel h3{margin:0 0 6px}
  #assistPanel .row{display:flex;gap:8px;flex-wrap:wrap;margin:8px 0}
  #assistPanel button{background:#1a2330;color:#E8F1F2;border:1px solid #2a394b;border-radius:10px;padding:8px 12px;cursor:pointer}
  #assistPanel button.primary{background:#00C2A8;color:#00141B;border:0}
  #assistPanel pre{max-height:160px;overflow:auto;background:#0b121a;border:1px solid #1f2a3a;border-radius:10px;padding:10px;margin:8px 0;font-size:12px}
  #assistPanel textarea{width:100%;height:120px;background:#0b121a;border:1px solid #1f2a3a;border-radius:10px;color:#E8F1F2;padding:8px;font-size:12px}
  .ok{color:#1bd5a6}.warn{color:#ffbe55}.err{color:#ff6b6b}
</style>

<button id="assistFab">üõ†Ô∏è Aide</button>
<div id="assistPanel" role="dialog" aria-label="Assistance Recallia">
  <h3>Assistance Recallia</h3>
  <div class="row">
    <button id="btnCheck" class="primary">V√©rifier le site</button>
    <button id="btnCopyDiag">Copier diagnostic</button>
    <button id="btnWire">Forcer branchement Cr√©ateur</button>
  </div>
  <pre id="assistLog" aria-live="polite">Pr√™t. Clique ‚ÄúV√©rifier le site‚Äù.</pre>

  <div style="margin-top:6px;font-size:13px;color:#9fb0bb">Mini-patch (coller un bout d‚ÄôHTML/CSS/JS)</div>
  <textarea id="assistPatch" placeholder="Ex. &lt;style&gt;h1{letter-spacing:.5px}&lt;/style&gt; ou &lt;script&gt;alert('ok')&lt;/script&gt;"></textarea>
  <div class="row">
    <button id="btnAppend" class="primary">Ins√©rer avant &lt;/body&gt;</button>
    <button id="btnReplace">Remplacer contenu‚Ä¶</button>
    <input id="assistSelector" placeholder="CSS s√©lecteur (ex: #heroTitle)" style="flex:1;background:#0b121a;border:1px solid #1f2a3a;border-radius:10px;color:#E8F1F2;padding:8px" />
  </div>
</div>

<script>
(function(){
  const $=s=>document.querySelector(s);
  const logEl = $('#assistLog');
  const log = (t,cls)=>{ logEl.textContent = (logEl.textContent? logEl.textContent+'\n':'') + (cls?`[${cls.toUpperCase()}] `:'') + t; if(cls){ logEl.className = cls; } };

  // Toggle panneau
  $('#assistFab').onclick = ()=>{ const p=$('#assistPanel'); p.style.display = p.style.display==='none'?'block':'none'; };

  // V√©rifications
  async function check(){
    logEl.textContent = '';
    const res = { url: location.href, time: new Date().toISOString(), checks:{} };

    // 1) Manifest
    const manifestHref = (document.querySelector('link[rel="manifest"]')?.getAttribute('href')) || 'manifest.webmanifest';
    res.checks.manifestHref = manifestHref;
    try{
      const r = await fetch(manifestHref, {cache:'no-store'});
      res.checks.manifestStatus = r.status;
      res.checks.manifestOk = r.ok;
      res.checks.manifestText = await r.text();
      log(`Manifest: ${manifestHref} ‚Üí ${r.status}`, r.ok?'ok':'err');
    }catch(e){ log('Manifest: √©chec de chargement', 'err'); }

    // 2) Service Worker
    if('serviceWorker' in navigator){
      const regs = await navigator.serviceWorker.getRegistrations();
      res.checks.swCount = regs.length;
      log(`Service Worker: ${regs.length>0?'registr√© ‚úî':'absent'}`, regs.length>0?'ok':'warn');
    }else{
      log('Service Worker: non support√©', 'warn');
    }

    // 3) Ic√¥nes
    const icons = ['icon-192.png','icon-512.png','ic√¥ne-192.png','ic√¥ne-512.png'];
    res.checks.icons = {};
    for (const i of icons){
      try{
        const r = await fetch(i, {method:'HEAD', cache:'no-store'});
        res.checks.icons[i] = r.ok ? r.status : '404';
        if(r.ok) log(`Ic√¥ne OK: ${i}`, 'ok');
      }catch(_){}
    }

    // 4) Ancre #app
    const app = document.getElementById('app') || Array.from(document.querySelectorAll('h2')).find(h=>/app|pwa/i.test(h.textContent||''))?.parentElement;
    res.checks.appAnchor = !!app;
    log(`Section #app ${app?'pr√©sente ‚úî':'absente'}`, app?'ok':'warn');

    // 5) Cr√©ateur (boutons)
    const creator = document.getElementById('creator') || document.querySelector('[data-creator]');
    const btnApply = creator && (creator.querySelector('#apply,[data-action="apply"]') || Array.from(creator.querySelectorAll('button')).find(b=>/appliq/i.test(b.textContent||'')));
    const btnPropose = creator && (creator.querySelector('#propose,[data-action="propose"]') || Array.from(creator.querySelectorAll('button')).find(b=>/propos/i.test(b.textContent||'')));
    const btnSave = creator && (creator.querySelector('#save,[data-action="save"]') || Array.from(creator.querySelectorAll('button')).find(b=>/sauveg|save/i.test(b.textContent||'')));
    res.checks.creator = { present: !!creator, apply: !!btnApply, propose: !!btnPropose, save: !!btnSave };
    log(`Cr√©ateur: ${creator?'pr√©sent':'absent'} / Apply:${!!btnApply} Propose:${!!btnPropose} Save:${!!btnSave}`, creator?'ok':'warn');

    // 6) Bouton ‚ÄúInstaller‚Äù (banni√®re potentielle)
    res.checks.installBanner = !!document.getElementById('pwaInstall');
    log(`Banni√®re install: ${res.checks.installBanner?'pr√©sente':'absente'}`, res.checks.installBanner?'ok':'warn');

    // Sauvegarde snapshot pour copier
    window.__recalliaDiag = res;
  }

  // Copier diagnostic
  $('#btnCopyDiag').onclick = async ()=>{
    try{
      await navigator.clipboard.writeText(JSON.stringify(window.__recalliaDiag || {note:'run check() first'}, null, 2));
      log('Diagnostic copi√©. Colle-le dans le chat.','ok');
    }catch(e){ log('Impossible de copier (autorise le presse-papier).','warn'); }
  };

  // Forcer branchement Cr√©ateur sur le h√©ro
  $('#btnWire').onclick = ()=>{
    const heroTitle = document.getElementById('heroTitle') || document.querySelector('h1');
    const heroSub   = document.getElementById('heroSub')   || (heroTitle? heroTitle.nextElementSibling : null);
    const heroCTA   = document.getElementById('heroCta')   || document.querySelector('a.btn,.cta a,nav a.btn');

    const creator = document.getElementById('creator') || document.querySelector('[data-creator]');
    if(!creator){ log('Cr√©ateur introuvable.','err'); return; }

    const inputs = creator.querySelectorAll('input,textarea');
    const applyBtn = creator.querySelector('#apply,[data-action="apply"]') || Array.from(creator.querySelectorAll('button')).find(b=>/appliq/i.test(b.textContent||''));
    const proposeBtn = creator.querySelector('#propose,[data-action="propose"]') || Array.from(creator.querySelectorAll('button')).find(b=>/propos/i.test(b.textContent||''));
    const saveBtn = creator.querySelector('#save,[data-action="save"]') || Array.from(creator.querySelectorAll('button')).find(b=>/sauveg|save/i.test(b.textContent||''));

    function setAccent(hex){
      if(!/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test((hex||'').trim())) return;
      document.documentElement.style.setProperty('--accent', hex.trim());
      const m = document.querySelector('meta[name="theme-color"]') || (()=>{const x=document.createElement('meta');x.name='theme-color';document.head.appendChild(x);return x;})();
      m.content = hex.trim();
    }

    proposeBtn && (proposeBtn.onclick = ()=>{
      const ideas = [
        {t:'Votre m√©moire IA ‚Äî encore plus simple.', s:'Vous validez, on ex√©cute. Re√ßus horodat√©s (hash + audit).', c:'Essayer maintenant', a:'#00C2A8'},
        {t:'Rappelle, ex√©cute, prouve.', s:'Anniversaires, RDV, factures ‚Äî preuve par d√©faut.', c:'Voir une preuve', a:'#60A5FA'},
        {t:'Ne rien oublier. Jamais.', s:'Priorit√©s du jour ‚Üí action ‚Üí re√ßu.', c:'D√©marrer', a:'#22D3EE'}
      ];
      const i = ideas[Math.floor(Math.random()*ideas.length)];
      inputs[0] && (inputs[0].value = i.t);
      inputs[1] && (inputs[1].value = i.s);
      inputs[2] && (inputs[2].value = i.c);
      inputs[3] && (inputs[3].value = i.a);
      log('Propositions pr√™tes (remplies dans le formulaire).','ok');
    });

    applyBtn && (applyBtn.onclick = ()=>{
      const title  = inputs[0]?.value?.trim();
      const sub    = inputs[1]?.value?.trim();
      const cta    = inputs[2]?.value?.trim();
      const accent = inputs[3]?.value?.trim();

      if(title && heroTitle) heroTitle.textContent = title;
      if(sub && heroSub && heroSub.tagName==='P') heroSub.textContent = sub;
      if(cta && heroCTA) heroCTA.textContent = cta;
      if(accent) setAccent(accent);

      log('Modifs appliqu√©es au h√©ro (non sauvegard√©es).','ok');
    });

    saveBtn && (saveBtn.onclick = ()=>{
      const state = {
        title: heroTitle?.textContent||'',
        sub: heroSub?.textContent||'',
        cta: heroCTA?.textContent||'',
        accent: getComputedStyle(document.documentElement).getPropertyValue('--accent').trim()
      };
      localStorage.setItem('recallia.site', JSON.stringify(state));
      log('Sauvegard√© localement (localStorage).','ok');
    });

    log('Branchement du Cr√©ateur effectu√©.','ok');
  };

  // V√©rifier
  $('#btnCheck').onclick = check;

  // Mini-patchs
  $('#btnAppend').onclick = ()=>{
    const html = $('#assistPatch').value;
    if(!html.trim()) return log('Rien √† ins√©rer.','warn');
    document.body.insertAdjacentHTML('beforeend', html);
    log('Patch ins√©r√© avant </body>.','ok');
  };
  $('#btnReplace').onclick = ()=>{
    const sel = $('#assistSelector').value.trim();
    const html = $('#assistPatch').value;
    if(!sel){ return log('S√©lecteur requis.','warn'); }
    const el = document.querySelector(sel);
    if(!el){ return log('√âl√©ment non trouv√©: '+sel,'err'); }
    el.innerHTML = html;
    log('Contenu remplac√© pour '+sel,'ok');
  };
})();
</script>
<!-- ==== CTA collant + Modal contact (drop-in) ==== -->
<style>
  #ctaBar{position:fixed;left:12px;right:12px;bottom:12px;display:flex;gap:10px;
    background:#0E1116;border:1px solid #263238;border-radius:12px;padding:10px;z-index:9998;
    align-items:center;justify-content:space-between;box-shadow:0 8px 30px rgba(0,0,0,.35)}
  #ctaBar .left{display:flex;gap:8px;align-items:center;color:#b9c1c7;font-size:14px}
  #ctaBar .btn{padding:10px 14px;border-radius:10px;border:none;font-weight:700;cursor:pointer}
  #ctaTry{background:#00C2A8;color:#001015}
  #ctaContact{background:#1B2631;color:#EAF2F8;border:1px solid #2C3E50}
  @media (max-width:520px){#ctaBar .left span{display:none}}
  /* Modal */
  #contactBack{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;z-index:9999}
  #contactBox{position:fixed;inset:auto 12px 12px 12px;max-width:560px;margin:auto;
    background:#0E1116;border:1px solid #263238;border-radius:14px;padding:16px;display:none;z-index:10000}
  #contactBox h3{margin:0 0 8px;font-size:18px;color:#EAF2F8}
  #contactBox label{font-size:13px;color:#b9c1c7}
  #contactBox input,#contactBox textarea{width:100%;margin:6px 0 12px;padding:10px;border-radius:10px;
    border:1px solid #25313B;background:#0B1116;color:#EAF2F8}
  #contactSend{background:#00C2A8;color:#001015} #contactClose{background:#1B2631;color:#EAF2F8;margin-left:8px}
</style>

<div id="ctaBar" role="region" aria-label="Actions principales">
  <div class="left"><strong>Recallia</strong> <span>‚Äî Votre m√©moire IA</span></div>
  <div class="right">
    <button id="ctaTry" class="btn">Essayer maintenant</button>
    <button id="ctaContact" class="btn">Contacter</button>
  </div>
</div>

<div id="contactBack"></div>
<div id="contactBox" role="dialog" aria-modal="true" aria-labelledby="contactTitle">
  <h3 id="contactTitle">Demander une d√©mo</h3>
  <form id="contactForm">
    <label>Nom</label>
    <input name="name" required>
    <label>Email</label>
    <input name="email" type="email" required>
    <label>Message</label>
    <textarea name="message" rows="4" placeholder="Ex : Je veux un rappel m√©decin + envoi d‚Äôun mail‚Ä¶" required></textarea>
    <div style="display:flex;justify-content:flex-end">
      <button type="button" id="contactClose" class="btn">Fermer</button>
      <button type="submit" id="contactSend" class="btn">Envoyer</button>
    </div>
    <p id="contactStatus" style="margin:8px 0 0;font-size:13px;color:#b9c1c7"></p>
  </form>
</div>

<script>
(() => {
  // Scroll sur le bloc #app si pr√©sent, sinon top
  document.getElementById('ctaTry')?.addEventListener('click', () => {
    const app = document.querySelector('#app') || document.body;
    app.scrollIntoView({behavior:'smooth', block:'start'});
  });

  // Modal contact (sans backend : mailto imm√©diat + hook Formspree optionnel)
  const back = document.getElementById('contactBack');
  const box  = document.getElementById('contactBox');
  const open = () => { back.style.display='block'; box.style.display='block'; };
  const close= () => { back.style.display='none';  box.style.display='none'; };
  document.getElementById('ctaContact')?.addEventListener('click', open);
  document.getElementById('contactClose')?.addEventListener('click', close);
  back.addEventListener('click', close);

  // Envoi : par d√©faut ouvre le client mail (rempla√ßable par Formspree plus tard)
  const form = document.getElementById('contactForm'), status = document.getElementById('contactStatus');
  form?.addEventListener('submit', (e) => {
    e.preventDefault();
    const d = new FormData(form);
    const nom = encodeURIComponent(d.get('name')||'');
    const em  = encodeURIComponent(d.get('email')||'');
    const msg = encodeURIComponent(d.get('message')||'');
    // üëâ Option A (imm√©diat) : mailto
    window.location.href = `mailto:jeason.bacoul@gmail.com?subject=Demande%20d%C3%A9mo%20Recallia&body=Nom:%20${nom}%0AEmail:%20${em}%0A%0A${msg}`;
    status.textContent = "Ouverture de votre messagerie‚Ä¶";
    setTimeout(close, 1200);

    // üëâ Option B (quand tu voudras) : Formspree
    // fetch('https://formspree.io/f/TON_ID_ICI',{method:'POST',body:d})
    //   .then(r=>r.ok?(status.textContent='Merci, on vous r√©pond vite.',setTimeout(close,1000))
    //                 :(status.textContent='Erreur. R√©essayez.'))
    //   .catch(()=>status.textContent='Erreur r√©seau.');
  });
})();
</script><!-- ===== /Assist v2 ===== --><!-- ===== /Correctif global ===== -->
</body>
  </html>
